name: Release

on:
  push:
    tags:
      - 'v*'

jobs:
  release:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'
          cache-dependency-path: lazy-sheep-userscript/package-lock.json
      
      - name: Install dependencies
        working-directory: lazy-sheep-userscript
        run: npm ci
      
      - name: Build userscript
        working-directory: lazy-sheep-userscript
        run: npm run build
      
      - name: Get version from tag
        id: get_version
        run: echo "VERSION=${GITHUB_REF#refs/tags/v}" >> $GITHUB_OUTPUT
      
      - name: Create Release
        uses: softprops/action-gh-release@v1
        with:
          name: 'v${{ steps.get_version.outputs.VERSION }}'
          draft: false
          prerelease: false
          generate_release_notes: true
          files: |
            lazy-sheep-userscript/dist/*.user.js
            lazy-sheep-userscript/dist/*.LICENSE.txt
          body: |
            ## ğŸ‰ æ‡’ç¾Šç¾Šè‡ªåŠ¨åŒ–å¹³å° v${{ steps.get_version.outputs.VERSION }}
            
            ### ğŸ“¦ å®‰è£…æ–¹å¼
            
            **Tampermonkeyç”¨æˆ·**ï¼š
            1. ç‚¹å‡»ä¸‹æ–¹ `lazy-sheep-auto-answer.user.js` æ–‡ä»¶
            2. Tampermonkeyä¼šè‡ªåŠ¨è¯†åˆ«å¹¶å®‰è£…
            
            **ScriptCatç”¨æˆ·**ï¼š
            1. ç‚¹å‡»ä¸‹æ–¹ `lazy-sheep-auto-answer.user.js` æ–‡ä»¶
            2. ScriptCatä¼šè‡ªåŠ¨è¯†åˆ«å¹¶å®‰è£…
            
            ### âœ¨ ä¸»è¦åŠŸèƒ½
            
            - ğŸ¯ è‡ªåŠ¨ç­”é¢˜ï¼ˆå•é€‰ã€å¤šé€‰ã€åˆ¤æ–­ã€å¡«ç©ºã€ç®€ç­”ï¼‰
            - ğŸ¤– AIæ™ºèƒ½è§£ç­”ï¼ˆDeepSeek V3/R1ï¼‰
            - ğŸ“š äº‘ç«¯é¢˜åº“æœç´¢
            - ğŸ”„ æ™ºèƒ½çº é”™ä¸ç­”æ¡ˆä¸Šä¼ 
            - ğŸš€ è‡ªåŠ¨åˆ·è¯¾ï¼ˆè§†é¢‘æ’­æ”¾ã€å€é€Ÿã€è‡ªåŠ¨è·³è½¬ï¼‰
            
            ### ğŸ”‘ å…è´¹ä½¿ç”¨
            
            è„šæœ¬å·²å†…ç½®å…è´¹APIå¯†é’¥ï¼Œå®‰è£…å³å¯ä½¿ç”¨ï¼
            
            - æ¯æ—¥é…é¢ï¼š100,000 æ¬¡
            - æ¯æœˆé…é¢ï¼š3,000,000 æ¬¡
            
            ### ğŸ› é—®é¢˜åé¦ˆ
            
            - [GitHub Issues](https://github.com/Lyy22223/Lazy-Sheep-Automation/issues)
            
            ### ğŸ™ æ„Ÿè°¢ä½¿ç”¨
            
            å¦‚æœè§‰å¾—å¥½ç”¨ï¼Œè¯·ç»™ä¸ªâ­Staræ”¯æŒä¸€ä¸‹ï¼
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
