# 答案库结构说明

## 答题记录结构分析

### 当前结构（答题记录_2025-11-28.json）

```json
{
  "id": "题目ID",
  "questionId": "题目ID",
  "type": "0",  // 0=单选, 1=多选, 2=判断, 3=填空, 4=简答
  "questionContent": "题目内容",
  "answer": "答案",
  "solution": "解析（目前为空）",
  "timestamp": 时间戳,
  "status": "已答"
}
```

### 优点 ✅
1. **题目ID** - 可以精确匹配题目
2. **题目类型** - 可以分类处理
3. **题目内容** - 支持文本搜索
4. **答案** - 核心信息完整
5. **时间戳** - 记录答题时间

### 不足 ⚠️
1. **缺少选项信息** - 对于选择题，选项很重要，但当前结构没有
2. **solution为空** - 解析说明字段存在但为空
3. **无法显示完整题目** - 搜题时无法显示选项

## 增强版答案库结构（answer.json）

### 推荐结构

```json
[
  {
    "id": "题目ID",
    "questionId": "题目ID",
    "type": "0",
    "questionContent": "题目内容",
    "answer": "C",  // 单选题：单个字母；多选题：逗号分隔 "A,B,D"
    "options": [    // 仅选择题有此字段
      "A、选项1",
      "B、选项2",
      "C、选项3",
      "D、选项4"
    ],
    "solution": "解析说明（如有）",
    "timestamp": 时间戳,
    "status": "已答"
  }
]
```

### 增强点
1. ✅ **添加options字段** - 选择题包含完整选项列表
2. ✅ **保留原有字段** - 完全兼容答题记录格式
3. ✅ **支持文本搜索** - 可通过questionContent搜索
4. ✅ **支持ID搜索** - 可通过id/questionId精确匹配
5. ✅ **支持选项搜索** - 可通过options内容搜索

## 搜题功能建议

### 搜索方式
1. **按题目内容搜索** - 模糊匹配 `questionContent`
2. **按题目ID搜索** - 精确匹配 `id` 或 `questionId`
3. **按选项内容搜索** - 在 `options` 中搜索关键词
4. **按题目类型筛选** - 通过 `type` 字段筛选

### 使用示例

```python
# 示例：搜索题目
def search_question(answer_bank, keyword):
    results = []
    for entry in answer_bank:
        # 搜索题目内容
        if keyword.lower() in entry.get('questionContent', '').lower():
            results.append(entry)
        # 搜索选项内容
        options = entry.get('options', [])
        for option in options:
            if keyword.lower() in option.lower():
                results.append(entry)
                break
    return results

# 示例：按ID查找
def find_by_id(answer_bank, question_id):
    for entry in answer_bank:
        if entry.get('id') == question_id or entry.get('questionId') == question_id:
            return entry
    return None
```

## 结论

### 答题记录结构是否够用？
- **基本够用** ✅ - 可以满足基本的搜题需求
- **建议增强** 💡 - 添加options字段后更适合作为完整的答案库

### 推荐方案
使用增强版结构（包含options字段），这样：
1. 可以显示完整题目（包括选项）
2. 支持更多搜索方式
3. 保持向后兼容（原有字段都保留）
4. 更适合作为答案库使用

## 脚本功能说明

### 1. update_answer_bank.py - 答案库更新脚本

**功能：**
- 从 `res.json`（已答题题库）中提取正确答案
- **特殊处理：判断题答错时自动提取正确答案**（对↔错）
- 将正确答案保存到 `answer.json` 文件中（增强版格式）

**使用方法：**
```bash
python update_answer_bank.py
```

**输出：**
- `answer.json` - 增强版答案库文件
- `answer.json.backup` - 自动备份原文件

### 2. search_answer.py - 答案库搜索脚本

**功能：**
实现答案库的多种搜索方式：
1. **按题目内容搜索** - 模糊匹配 `questionContent`
2. **按题目ID搜索** - 精确匹配 `id` 或 `questionId`
3. **按选项内容搜索** - 在 `options` 中搜索关键词
4. **按题目类型筛选** - 通过 `type` 字段筛选

**使用方法：**

**交互式模式：**
```bash
python search_answer.py
```

**命令行模式：**
```bash
# 按关键词搜索
python search_answer.py "Spring Boot"

# 按ID搜索
python search_answer.py "#5ae2df26223742f083202749dcb7769a"

# 按类型筛选
python search_answer.py "Spring" "0"  # 搜索包含"Spring"的单选题
```

**搜索示例：**
```
请输入搜索条件: Spring Boot
找到 15 道题目

[1/15]
【单选题】ID: 5ae2df26223742f083202749dcb7769a
题目: 下列选项中，对于创建Maven项目时...
选项:
  A、Group为项目的组名...
  B、Artifact为项目的名称...
  C、Artifact为所创建项目在本地存放的路径
  D、Group和Artifact是Maven区分项目包的字段
答案: C
-------------------------------------------
```

### 判断题特殊处理

**判断题答错自动提取正确答案：**
- 如果判断题答错了（`correct: false`），脚本会自动提取正确答案
- "对" ↔ "错" 自动转换
- 确保答案库中保存的都是正确答案

